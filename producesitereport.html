<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Site Report</title>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script>
        function getSiteHabitatInfo(sitehabitatID) {
            $.ajax({
                type: 'Get',
                dataType: 'JSON',
                url: 'https://nzwetland.herokuapp.com/api/Sitehabitat/' + sitehabitatID + '/',
                success: function(data) {
                    // location.reload();
                    sitehabitat = data;
                },
                error: function(err) {
                    console.log(err);
                }
            });
            return sitehabitat;
        }

        function getHabitatInfo(habitatID) {
            $.ajax({
                type: 'Get',
                dataType: 'JSON',
                async: false,
                url: 'https://nzwetland.herokuapp.com/api/habitat/' + habitatID + '/',
                success: function(data) {
                    // location.reload();
                    habitat = data;
                },
                error: function(err) {
                    console.log(err);
                }
            });
            return habitat;
        }

        $(document).ready(function () {
            $.ajax({
                type: 'GET',
                url: "https://nzwetland.herokuapp.com/api/site/",
                dataType: "JSON",
                success: function (data) {
                    var i = 0;
                    while (i < data.length){
                        site = data[i];
                        $("#sites").append("<hr>");
                        $("#sites").append("<table><tr><td id = 'site_id'><b>Site ID:</b> "+site.id+" </td><td><b>Area:</b> "+site.area+"</td><td><b>Altitude:</b> "+site.altitude+"</td></tr> " +
                            "<tr><td><b>Site Name:</b> "+site.sitename+" </td><td><b>Site Type:</b> "+site.sitetype+"</td><td><b>Status:</b> "+site.status+"</td></tr></table>");
                        // sitehabitat = getSiteHabitatInfo(i);
                        // habitat = getHabitatInfo(sitehabitat.habitat);
                        // $("#sites").append("<table><tr><td><b>Site Habitat ID:</b> "+sitehabitat.id+" </td><td><b>Site Habitat Name:</b> "+sitehabitat.sitehabitatname+"</td><td><b>Habitat Description:</b> "+habitat.description+"</td></tr></table>");
                        i++;
                    }
                },
                error: function () {
                    alert("Not connected");
                }
            });
            $("#display_report").click(function () {
                $("#sites").show();

            })
        });

       windows.onload = function ()
       {
           $("#sites").hide();
       }
        function back() {
            window.history.back();
        }
    </script>
</head>

<body>
<form onsubmit="return false">
    <div class="center">
        <h1>Site Report</h1>
        <div class="center_button">
            <button type="button" style="width: 250px"><a id="display_report" href=""> Display Site Report</a></button>
            <button type="button"><a href="mainMenuBigEye.html"> Return</a></button>
        </div>
        <div id="sites" style="display: none"></div>
    </div>
</form>
</body>
</html>